@typeparam TTaxonomy where TTaxonomy : BaseTaxonomyModel

<TagsInput
    DataSource="_entities"
    OnCreateTag="Add"
    Values="Values"
    ValuesChanged="ValuesChanged"
    OptionLabelSelector="t => t.Name" />

@code {
    [Parameter] public required BaseDatabaseService<TTaxonomy> DataService { get; set; }
    [Parameter] public required ICollection<TTaxonomy>? Values { get; set; }
    [Parameter] public EventCallback<ICollection<TTaxonomy>> ValuesChanged { get; set; }

    ICollection<TTaxonomy> _entities = new List<TTaxonomy>();

    protected override async Task OnInitializedAsync()
    {
        _entities = await DataService.AsNoTracking().GetAsync();
    }

    async Task<TTaxonomy> Add(string name)
    {
        var taxonomy = (TTaxonomy?)Activator.CreateInstance(typeof(TTaxonomy));

        if (taxonomy == null)
            throw new InvalidOperationException($"Could not create instance of type {nameof(TTaxonomy)}");

        taxonomy.Name = name;

        taxonomy = await DataService.AddAsync(taxonomy);

        return taxonomy;
    }
}